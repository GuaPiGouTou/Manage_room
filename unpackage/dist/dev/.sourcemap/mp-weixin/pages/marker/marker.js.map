{"version":3,"file":"marker.js","sources":["pages/marker/marker.vue","D:/文档/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbWFya2VyL21hcmtlci52dWU"],"sourcesContent":["<template>\r\n  <view class=\"property-container\">\r\n\t\r\n    <!-- 顶部标题 -->\r\n      <view class=\"header\">\r\n        <text class=\"title\">{{ baseInfo.title || '未命名小区' }}</text>\r\n        <text class=\"location\">{{ baseInfo.location }}</text>\r\n      </view>\r\n      \r\n      <!-- 小区基本信息卡片 -->\r\n      <view class=\"info-card base-info\">\r\n        <view class=\"card-header\">\r\n          <text class=\"card-title\">小区基本信息</text>\r\n        </view>\r\n        \r\n        <view class=\"info-grid\">\r\n          <view class=\"info-item\">\r\n            <text class=\"info-label\">地址:</text>\r\n            <text class=\"info-value\">{{ baseInfo.address || '暂无数据' }}</text>\r\n          </view>\r\n          \r\n          <view class=\"info-item\">\r\n            <text class=\"info-label\">面积:</text>\r\n            <text class=\"info-value\">{{ baseInfo.area || '0' }}㎡</text>\r\n          </view>\r\n          \r\n          <view class=\"info-item\">\r\n            <text class=\"info-label\">联系电话:</text>\r\n            <text class=\"info-value\">{{ baseInfo.phone || '暂无数据' }}</text>\r\n          </view>\r\n          \r\n          <view class=\"info-item\">\r\n            <text class=\"info-label\">微信:</text>\r\n            <text class=\"info-value\">{{ baseInfo.wechat || '暂无数据' }}</text>\r\n          </view>\r\n\t\t  <view>\r\n\t\t\t  \t<button type=\"primary\" @click=\"insert_room(this.propertyId)\">添加房间</button>\r\n\t\t  </view>\r\n        </view>\r\n      </view>\r\n\t  \r\n\t   <!-- 房间列表 -->\r\n\t      <view  class=\"info-card room-list\">\r\n\t        <view class=\"card-header\">\r\n\t          <text class=\"card-title\" @tap=\"room\">房源信息 ({{ baseInfo.roomcount }}间)</text>\r\n\t        </view>\r\n\t     \r\n\t        <!-- 房间卡片 -->\r\n\t       <view \r\n\t          v-for=\"(room, index) in baseInfo.room\" \r\n\t          :key=\"index\" \r\n\t          class=\"room-card\"\r\n\t        >\r\n\t          <view class=\"room-header\">\r\n\t            <text class=\"room-number\">{{ room.roomNumber || '未编号' }}</text>\r\n\t            <text class=\"room-type\">{{ room.roomType || '未分类' }}</text>\r\n\t          </view>\r\n\t          \r\n\t          <view class=\"room-details\">\r\n\t            <view class=\"detail-item\">\r\n\t              <text class=\"detail-label\">地址:</text>\r\n\t              <text class=\"detail-value\">{{ room.roomAddress || '同小区地址' }}</text>\r\n\t            </view>\r\n\t            \r\n\t            <view class=\"detail-item\">\r\n\t              <text class=\"detail-label\">面积:</text>\r\n\t              <text class=\"detail-value\">{{ room.roomArea || '0' }}㎡</text>\r\n\t            </view>\r\n\t            \r\n\t            <view class=\"detail-item\">\r\n\t              <text class=\"detail-label\">支付方式:</text>\r\n\t              <text class=\"detail-value\">\r\n\t                {{ formatPayment(room.roomPayment) }}\r\n\t              </text>\r\n\t            </view>\r\n\t            \r\n\t            <view class=\"detail-item\">\r\n\t              <text class=\"detail-label\">家具配置:</text>\r\n\t              <text class=\"detail-value\">\r\n\t                {{ formatFurniture(room.roomFurniture) }}\r\n\t              </text>\r\n\t            </view>\r\n\t\t\t\t<view >\r\n\t\t\t\t\t<button type=\"warn\"  @click=\"delete_room(room.roomId,index)\">删除房间</button>\r\n\t\t\t\t\r\n\t\t\t\t</view>\r\n\t          </view>\r\n\t          \r\n\t          <!-- 视频预览 -->\r\n\t        <!-- 视频预览 -->\r\n\t        <view class=\"video-section\" v-if=\"room.roomVideo && room.roomVideo.length > 0\">\r\n\t          <text class=\"section-title\">视频预览</text>\r\n\t          <view class=\"video-thumbnails\">\r\n\t            <view \r\n\t              v-for=\"(video, videoIndex) in room.roomVideo\" \r\n\t              :key=\"videoIndex\" \r\n\t              class=\"video-thumb\" \r\n\t              @click=\"previewVideo(video)\"\r\n\t            >\r\n\t              <video  \r\n\t                class=\"video-icon\" \r\n\t\t\t\t\t:src=\"video\"\r\n\t              \r\n\t              ></video>\r\n\t              <text class=\"video-index\">视频{{ videoIndex + 1 }}</text>\r\n\t            </view>\r\n\t          </view>\r\n\t        </view>\r\n\t        </view>\r\n\t      </view>\r\n\t\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() { \r\n    return {\r\n\t\turls:[],\r\n\t\tpropertyId:1,\r\n      baseInfo: {\r\n        address: '',\r\n        longitude: 0,\r\n        latitude: 0,\r\n        wechat: '',\r\n        phone: '',\r\n        title: '',\r\n        location: '',\r\n        area: '',\r\n        roomcount: 0,\r\n        room: [{\r\n        roomId: 101,\r\n        roomNumber: \"101\",\r\n        roomAddress: \"主卧\",\r\n        roomArea: 45.5,\r\n        roomType: \"主卧室\",\r\n        roomPayment: {\r\n          monthly: 8000,\r\n          quarterly: 22000,\r\n          yearly: 80000\r\n        },\r\n        roomFurniture: [true, true, true, false],\r\n        roomVideo: [\"video1\", \"video2\"],\r\n        propertyId: 1\r\n      }]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    // 这里应该是从API或store获取数据\r\n  \r\n  },\r\n  onLoad(res) {\r\n  \t\r\n\tthis.propertyId = res.id\r\n\tthis.getHouse(res.id)\r\n  },\r\n  methods: {\r\n\t// getvideo() {\r\n\t//   const that = this;\r\n\t  \r\n\t//   // 遍历所有房间\r\n\t//   this.baseInfo.room.forEach((room, roomIndex) => {\r\n\t//     // 检查是否有视频\r\n\t//     if (room.roomVideo && room.roomVideo.length > 0) {\r\n\t//       // 为每个视频文件获取临时URL\r\n\t//       wx.cloud.getTempFileURL({\r\n\t//         fileList: room.roomVideo.map(fileID => ({\r\n\t//           fileID: fileID,\r\n\t//           maxAge: 60 * 60 // 一小时有效期\r\n\t//         }))\r\n\t//       }).then(res => {\r\n\t//         // 更新视频URL数组\r\n\t//         const newVideoUrls = res.fileList.map(file => file.tempFileURL);\r\n\t        \r\n\t//         // 使用Vue的set方法确保响应式更新\r\n\t//         that.$set(that.baseInfo.room, roomIndex, {\r\n\t//           ...that.baseInfo.room[roomIndex],\r\n\t//           roomVideo: newVideoUrls\r\n\t//         });\r\n\t        \r\n\t//         console.log('更新后的房间数据:', that.baseInfo.room);\r\n\t//       }).catch(error => {\r\n\t//         console.error('获取视频临时URL失败:', error);\r\n\t//         uni.showToast({\r\n\t//           title: '获取视频链接失败',\r\n\t//           icon: 'none'\r\n\t//         });\r\n\t//       });\r\n\t//     }\r\n\t//   });\r\n\t// },\r\n\t  insert_room(id){\r\n\t\t  console.log(id)\r\n\t\t  uni.navigateTo({\r\n\t\t  \turl:\"/pages/marker/markerAddRoom?id=\"+id\r\n\t\t  })\r\n\t  },\r\n\t  delete_room(roomId,index){\r\n\t\t  console.log(roomId)\r\n\t\t  const res = wx.cloud.callContainer({\r\n\t\t\t  \"config\": {\r\n\t\t\t    \"env\": \"prod-7g3ji5ui73a4702f\"\r\n\t\t\t  },\r\n\t\t\t  \"path\": \"/api/room/delete?RoomId=\"+roomId,\r\n\t\t\t  \"header\": {\r\n\t\t\t    \"X-WX-SERVICE\": \"springboot-x535\",\r\n\t\t\t    \"content-type\": \"application/json\"\r\n\t\t\t  },\r\n\t\t\t  \"method\": \"GET\"\r\n\t\t  })\r\n\t\t  res.then((res)=>{\r\n\t\t\t  console.log(res)\r\n\t\t\t  \tif(res.data.code ===\"200\")\r\n\t\t\t\t{\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle:\"删除成功！\",\r\n\t\t\t\t\t\ticon:\"success\"\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.getHouse(this.propertyId)\r\n\t\t\t\t\t\r\n\t\t\t\t}else{\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle:\"删除失败！\",\r\n\t\t\t\t\t\ticon:\"error\"\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\r\n\t\t  })\r\n\t  },\r\n\t  room(){\r\n\t\tconsole.log(this.baseInfo.room)  \r\n\t  },\r\n\t  apiget(){\r\n\t\t  this.baseInfo.title = \"xxxx\"\r\n\t\t  \r\n\t  },\r\n\t  getHouse(id){\r\n\t\t  const succ =  wx.cloud.callContainer({\r\n\t\t    \"config\": {\r\n\t\t      \"env\": \"prod-7g3ji5ui73a4702f\"\r\n\t\t    },\r\n\t\t    \"path\": \"/api/house/gethouse?id=\"+id,\r\n\t\t    \"header\": {\r\n\t\t      \"X-WX-SERVICE\": \"springboot-x535\",\r\n\t\t      \"content-type\": \"application/json\"\r\n\t\t    },\r\n\t\t    \"method\": \"GET\"\r\n\t\t  })\r\n\t\t  console.log(succ)\r\n\t\t  succ.then((res)=>{\r\n\t\t  \tif(res.data.code ===\"200\")\r\n\t\t  \t this.baseInfo = res.data.data\r\n\t\t  \t // this.getvideo()\r\n\t\t  \tconsole.log(this.baseInfo)})\r\n\t\t  \r\n     \r\n    },\r\n\t formatPayment(payment) {\r\n\t      if (!payment) return '暂无数据'\r\n\t      const methods = []\r\n\t\t  console.log(payment)\r\n\t      if (payment.monthly) methods.push(`月付: ¥${payment.monthly}`)\r\n\t      if (payment.quarterly) methods.push(`半年付: ¥${payment.quarterly}`)\r\n\t      if (payment.yearly) methods.push(`年付: ¥${payment.yearly}`)\r\n\t      return methods.join(' / ') || '价格面议'\r\n\t    },\r\n\t    \r\n\t    formatFurniture(furniture) {\r\n\t      if (!furniture || !furniture.length) return '无'\r\n\t      const items = [\"浴缸\",\"花洒\",\"冰箱\",\"空调\",\"微波炉\",\"洗衣机\",\"油烟机\"]\r\n\t      return furniture\r\n\t        .map((hasItem, index) => hasItem ? items[index] : null)\r\n\t        .filter(Boolean)\r\n\t        .join('、') || '基础配置'\r\n\t    }\r\n\t    \r\n\t   } \r\n}\r\n</script>\r\n\r\n<style>\r\n/* 基础样式 */\r\n\r\n/* 视频区域 */\r\n.video-section {\r\n  margin-top: 20rpx;\r\n  padding-top: 15rpx;\r\n  border-top: 1rpx dashed #ddd;\r\n}\r\n\r\n.section-title {\r\n  font-size: 26rpx;\r\n  color: #666;\r\n  display: block;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.video-thumbnails {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 15rpx;\r\n}\r\n\r\n.video-thumb {\r\n  width: 200rpx;\r\n  height: 120rpx;\r\n  background-color: #f0f0f0;\r\n  border-radius: 8rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.video-icon {\r\n  width: 60rpx;\r\n  height: 60rpx;\r\n  opacity: 0.7;\r\n}\r\n\r\n.video-index {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-top: 10rpx;\r\n}\r\n\r\n.property-container {\r\n  padding: 20rpx;\r\n  background-color: #f5f5f5;\r\n  min-height: 100vh;\r\n}\r\n\r\n.header {\r\n  padding: 30rpx 20rpx;\r\n  background-color: #fff;\r\n  border-radius: 16rpx;\r\n  margin-bottom: 20rpx;\r\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.title {\r\n  font-size: 36rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n  display: block;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.location {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n/* 卡片样式 */\r\n.info-card {\r\n  background-color: #fff;\r\n  border-radius: 16rpx;\r\n  margin-bottom: 30rpx;\r\n  padding: 0 20rpx 20rpx;\r\n  box-shadow: 0 2rpx 10rpx rgba(0, 0, 0, 0.05);\r\n}\r\n\r\n.card-header {\r\n  padding: 20rpx 0;\r\n  border-bottom: 1rpx solid #eee;\r\n}\r\n\r\n.card-title {\r\n  font-size: 32rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n/* 基本信息网格 */\r\n.info-grid {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 20rpx;\r\n  padding-top: 20rpx;\r\n}\r\n\r\n.info-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.info-label {\r\n  font-size: 26rpx;\r\n  color: #999;\r\n  margin-bottom: 6rpx;\r\n}\r\n\r\n.info-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n}\r\n\r\n/* 房间卡片 */\r\n.room-card {\r\n  margin-top: 20rpx;\r\n  padding: 20rpx;\r\n  background-color: #f9f9f9;\r\n  border-radius: 12rpx;\r\n  border: 1rpx solid #eee;\r\n}\r\n\r\n.room-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 15rpx;\r\n  padding-bottom: 10rpx;\r\n  border-bottom: 1rpx dashed #ddd;\r\n}\r\n\r\n.room-number {\r\n  font-size: 30rpx;\r\n  font-weight: bold;\r\n  color: #333;\r\n}\r\n\r\n.room-type {\r\n  font-size: 26rpx;\r\n  color: #666;\r\n  background-color: #e6f7ff;\r\n  padding: 4rpx 12rpx;\r\n  border-radius: 20rpx;\r\n}\r\n\r\n/* 房间详情 */\r\n.room-details {\r\n  display: grid;\r\n  grid-template-columns: repeat(2, 1fr);\r\n  gap: 15rpx;\r\n}\r\n\r\n.detail-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.detail-label {\r\n  font-size: 26rpx;\r\n  color: #888;\r\n}\r\n\r\n.detail-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  word-break: break-all;\r\n}\r\n\r\n/* 视频区域 */\r\n.video-section {\r\n  margin-top: 20rpx;\r\n  padding-top: 15rpx;\r\n  border-top: 1rpx dashed #ddd;\r\n}\r\n\r\n.section-title {\r\n  font-size: 26rpx;\r\n  color: #666;\r\n  display: block;\r\n  margin-bottom: 10rpx;\r\n}\r\n\r\n.video-thumbnails {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 15rpx;\r\n}\r\n\r\n.video-thumb {\r\n  width: 300rpx;\r\n  height: 520rpx;\r\n  background-color: #f0f0f0;\r\n  border-radius: 8rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.video-icon {\r\n  width: 220rpx;\r\n  height: 1200rpx;\r\n  opacity: 0.7;\r\n}\r\n\r\n.video-index {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-top: 10rpx;\r\n}\r\n\r\n/* 响应式调整 */\r\n@media (min-width: 768px) {\r\n  .property-container {\r\n    max-width: 750px;\r\n    margin: 0 auto;\r\n  }\r\n  \r\n  .info-grid, .room-details {\r\n    grid-template-columns: repeat(3, 1fr);\r\n  }\r\n}\r\n</style>","import MiniProgramPage from 'E:/Manage_Project/demo/demo1/pages/marker/marker.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","wx","res"],"mappings":"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"}